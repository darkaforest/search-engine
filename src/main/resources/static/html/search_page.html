<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>搜索引擎</title>
    <link rel="stylesheet" type="text/css" href="../bootstrap/css/bootstrap.min.css">
    <script type="text/javascript" src="../jquery/jquery.min.js"></script>
    <script src="../angular/angular.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="../bootstrap/js/bootstrap.min.js"></script>
</head>
<body>

<div ng-app="mainapp">
    <div ng-controller="mainCtrl">
        <div class="row clearfix" style="margin-top: 10px;margin-left: 10px">
            <div class="col-md-1 column">
                <img src="https://www.baidu.com/img/baidu_resultlogo@2.png" width="100%"/>
            </div>
            <div class="col-md-5 column">
                <div class="form-group">
                    <input class="form-control input-lg" type="text">
                </div>
            </div>
            <div class="col-md-1 column">
                <button type="button" class="btn btn-primary btn-lg " ng-click="search()">立即搜索</button>
            </div>
            <div class="col-md-5 column">
            </div>
        </div>
        <div class="col-md-6 column" style="margin-top: 10px;margin-left: 150px" ng-repeat="x in results">
            <div style="margin-bottom: 15px">
                <h4 style="color: #0018c3">
                    <a href="{{x.url}}"><span style="text-decoration: underline">{{x.title}}</span></a>
                </h4>
                <div>
                    <img ng-if="x.hasPic" src="{{x.pic}}" align="left" style="margin-right: 10px"/>
                    <div style="color: #0018c3">
                        <span>{{x.summary}}</span>
                    </div>
                </div>
                <a style="color: green" href="{{x.url}}">{{x.source}}</a> -
                <span>{{x.timestamp | date:'yyyy-MM-dd hh:mm'}}</span>
                <a style="color: gray" href="{{x.url}}">网页快照</a>
            </div>
        </div>
        <div class="col-md-6 column">
        </div>
    </div>
</div>
</div>
<script type="text/javascript">
    var app = angular.module('mainapp', []);
    app.controller('mainCtrl', function ($scope, $http, $interval, $timeout) {
        $scope.search = function search() {
            $http({
                method: 'GET',
                url: '/test/search'
            }).then(function success(data) {
                $scope.results = data.data.data;
                $scope.total = data.count;
                $scope.results.forEach(function (curr) {
                    if (curr.pic !== undefined && curr.pic != null && curr.pic !== "") {
                        curr.hasPic = true;
                    }
                    else {
                        curr.hasPic = false;
                    }
                });
            }, function error() {
                alert('连接服务器失败');
            });
        }
    });
</script>
</body>
</html>